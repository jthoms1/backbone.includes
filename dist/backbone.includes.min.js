/*! backbone.includes - v0.1.0 - 2013-11-14 */(function(e,t){"use strict";if("function"==typeof define&&define.amd)define(["backbone","underscore"],function(e,i){t(e,i)});else if("undefined"!=typeof exports){var i=require("underscore"),n=require("backbone");t(n,i)}else t(e.Backbone,e._)})(this,function(e,t){"use strict";function i(e){return e.charAt(0).toUpperCase()+e.slice(1)}var n={getModelName:function(){return this.modelName||this.model.modelName},setIncludes:function(){return this._includesList={},t.each(arguments,function(e){var i=[];if(t.isArray(e)){var n=e.shift();i=e,e=n}this._includesList[e.prototype.getModelName()]={modelOrCollection:e,subIncludes:i}},this),this},_buildIncludes:function(e){var i=[];return t.each(e,function(e,t){var n=t;e.subIncludes.length>0&&(n+="/"+e.subIncludes[0].prototype.getModelName()),i.push(n)}),i.join()},sync:function(i,n,s){return this._includesList&&(s.data=t.extend({includes:this._buildIncludes(this._includesList)},s.data||{})),e.sync.call(this,i,n,s)}},s={set:t.wrap(e.Model.prototype.set,function(e,t,i,n){return e.call(this,t,i,n),this._updateIncludesMethods(),this}),_updateIncludesMethods:function(){var e={};this._includesList?e=this._includesList:this.collection&&this.collection._includesList&&(e=this.collection._includesList),t.each(e,function(e,t){this._includeMethod(e.modelOrCollection,t,e.subIncludes)},this)},_includeMethod:function(e,n,s){var u="get"+i(n);t.isArray(this.get(n))?u+="s":e=e.prototype.model||e,this[u]=this._getAttributeMethod(e,n,s)},_getAttributeMethod:function(e,t,i){var n=this;return function(){if(this._includedListValues=this._includedListValues||{},n._includedListValues[t])return n._includedListValues[t];var s=n._includedListValues[t]=new e;return s.setIncludes.apply(s,i),s.set(n.get(t)),s}}};t.extend(e.Model.prototype,s,n),t.extend(e.Collection.prototype,n)});